---
title: "æœé¢¨å‘‚ã«å…¥ã‚ŠãªãŒã‚‰zoomã‚’è‡ªå‹•é€€å‡ºã—ãŸã„"
emoji: "ğŸ˜½"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [python, zoom]
published: True
---

## å‹•æ©Ÿ

ã‚®ãƒªã‚®ãƒªã¾ã§ç¡çœ æ™‚é–“ã‚’ç¢ºä¿ã—ãŸã‹ã£ãŸã€‚


## å®Ÿè¡Œç’°å¢ƒ
- OS: macOS Ventura Version13.2.1 (M1ãƒãƒƒãƒ—)
- Python 3.11.4

## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

```python
import subprocess
import time

def join_zoom_meeting(meeting_id, password):
    command = f"zoommtg://zoom.us/join?action=join&confno={meeting_id}&pwd={password}"
    subprocess.call(["open", command])

def close_zoom_window():
    subprocess.call(["pkill", "zoom.us"])

def main():
    meeting_id = "YOUR_MEETING_ID"  # ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°IDã‚’ã“ã“ã«å…¥åŠ›
    password = "YOUR_PASSWORD"     # ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã“ã“ã«å…¥åŠ›
    target_time = "10:30:00"  # é–‹å§‹ã™ã‚‹æ™‚é–“ã‚’æŒ‡å®š (24æ™‚é–“å½¢å¼)
    meeting_duration = 87  # ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®æŒç¶šæ™‚é–“ã‚’æŒ‡å®š (åˆ†å˜ä½)

    while True:
        current_time = time.strftime("%H:%M:%S")
        if current_time >= target_time:
            join_zoom_meeting(meeting_id, password)
            time.sleep(meeting_duration * 60)  # åˆ†å˜ä½ã‹ã‚‰ç§’å˜ä½ã«å¤‰æ›
            close_zoom_window()
            break
        else:
            time.sleep(1)

if __name__ == "__main__":
    main()
```
ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å†…ã®`meeting_id`ã¨`password`ã¯è‡ªåˆ†ã®ã‚‚ã®ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚
ä¸Šè¨˜ã§ã¯ã€10:30:00ã«ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«å‚åŠ ã—ã€87åˆ†å¾Œã«ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‹ã‚‰é€€å‡ºã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

## è¿½åŠ 
æˆæ¥­ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’è‡ªå‹•ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã™ã‚‹ã‚ˆã†ãªæ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸã„ã¨æ€ã£ãŸã€‚(ã¾ã è©¦è¡ŒéŒ¯èª¤ä¸­)

å…·ä½“çš„ã«ã¯ã€OpenCVã§å‹•ä½“æ¤œçŸ¥ã—ã¦ã€ä¾‹ãˆã°ç”»é¢å…¨ä½“ã®5å‰²ãŒå¤‰åŒ–ã—ãŸã‚‰ã€ã‚¹ã‚¯ã‚·ãƒ§ã‚’ã™ã‚‹ã‚ˆã†ãªæ„Ÿã˜ã€‚

```python
import subprocess
import time
import cv2
import numpy as np
from PIL import ImageGrab

# ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆä¿å­˜å…ˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹
SCREENSHOT_DIR = "/screenshot/zoom"

# å‹•ä½“æ¤œçŸ¥ã®ã—ãã„å€¤ï¼ˆç”»é¢å…¨ä½“ã®å¤‰åŒ–ã®å‰²åˆï¼‰
MOTION_THRESHOLD = 0.5

def join_zoom_meeting(meeting_id, password):
    command = f"zoommtg://zoom.us/join?action=join&confno={meeting_id}&pwd={password}"
    subprocess.call(["open", command])

def close_zoom_window():
    subprocess.call(["pkill", "zoom.us"])

def capture_screenshot():
    screenshot = ImageGrab.grab()
    timestamp = time.strftime("%Y%m%d_%H%M%S")
    screenshot_path = f"{SCREENSHOT_DIR}/screenshot_{timestamp}.png"
    screenshot.save(screenshot_path)
    print(f"Screenshot saved: {screenshot_path}")

def main():
    meeting_id = "YOUR_MEETING_ID"  # ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°IDã‚’ã“ã“ã«å…¥åŠ›
    password = "YOUR_PASSWORD"     # ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã“ã“ã«å…¥åŠ›
    target_time = "10:30:00"  # é–‹å§‹ã™ã‚‹æ™‚é–“ã‚’æŒ‡å®š (24æ™‚é–“å½¢å¼)
    meeting_duration = 1  # ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®æŒç¶šæ™‚é–“ã‚’æŒ‡å®š (åˆ†å˜ä½)
    motion_frames = []
    
    while True:
        current_time = time.strftime("%H:%M:%S")
        if current_time >= target_time:
            join_zoom_meeting(meeting_id, password)
            start_time = time.time()
            
            while True:
                # ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å–å¾—ã—ã€å‰å›ã®ãƒ•ãƒ¬ãƒ¼ãƒ ã¨æ¯”è¼ƒã™ã‚‹
                screenshot = np.array(ImageGrab.grab())
                gray = cv2.cvtColor(screenshot, cv2.COLOR_BGR2GRAY)
                gray = cv2.GaussianBlur(gray, (21, 21), 0)
                
                if len(motion_frames) < 2:
                    motion_frames.append(gray)
                    continue
                
                frame_delta = cv2.absdiff(motion_frames[0], gray)
                thresh = cv2.threshold(frame_delta, 30, 255, cv2.THRESH_BINARY)[1]
                thresh = cv2.dilate(thresh, None, iterations=2)
                contours, _ = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
                motion_detected = False
                
                for contour in contours:
                    if cv2.contourArea(contour) > 500:
                        motion_detected = True
                        break
                
                if motion_detected:
                    motion_frames.pop(0)
                    motion_frames.append(gray)
                    elapsed_time = time.time() - start_time
                    
                    if elapsed_time >= meeting_duration * 60:
                        capture_screenshot()
                        close_zoom_window()
                        break
                else:
                    motion_frames.pop(0)
                    motion_frames.append(gray)
                
                time.sleep(0.1)
            
            break
        else:
            time.sleep(1)

if __name__ == "__main__":
    main()
```
ã¾ã ã€å‹•ä½œç¢ºèªã¯ã§ãã¦ã„ã¾ã›ãˆã‚“ã€‚
ã‚³ãƒ¡ãƒ³ãƒˆãŠå¾…ã¡ã—ã¦ã„ã¾ã™ã€‚

## å‚è€ƒãƒ»ä½¿ã£ãŸã‚‚ã®
ChatGPTãã‚“
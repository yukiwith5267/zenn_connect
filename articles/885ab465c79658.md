---
title: "Zoomã‚’è‡ªå‹•å…¥é€€å‡ºã—ã¦ã€æŽˆæ¥­ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’è‡ªå‹•ã‚¹ã‚¯ã‚·ãƒ§ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œã‚ŠãŸã„ã€‚"
emoji: "ðŸ·"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---

## ã¯ã˜ã‚ã«
ã“ã®è¨˜äº‹ã¯ã€[ã€Pythonã€‘æœé¢¨å‘‚ã«å…¥ã‚ŠãªãŒã‚‰Zoomã‚’è‡ªå‹•å…¥é€€å‡º](https://zenn.dev/yukitezuka/articles/53ffd07749d0ec) ã®ç¶šãã§ã™ã€‚

å‰å›žã¯ã€æŒ‡å®šã—ãŸæ™‚é–“ã«å…¥å®¤ã—ã¦ã€ä¸€å®šæ™‚é–“å¾Œã«zoomã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜ã‚‹ã“ã¨ã«ã‚ˆã£ã¦é€€å‡ºã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿç¾ã—ãŸã€‚

ã“ã‚Œã«ã€æŽˆæ¥­ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’è‡ªå‹•ã‚¹ã‚¯ã‚·ãƒ§ã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸã„ã¨æ€ã£ãŸã€‚ç†ç”±ã¯ã€æœŸæœ«è©¦é¨“ãŒè¿‘ã¥ã„ã¦ããŸã®ã§ã€æ•™æŽˆã®æ‰‹æ›¸ãã®ãƒ¡ãƒ¢ã‚’ä¿ç®¡ã—ã¦ãŠããŸã„ã¨æ€ã£ãŸã‹ã‚‰ã§ã‚ã‚‹ã€‚

## æ‰‹æ³•
2é€šã‚Šã®æ–¹æ³•ã‚’æ€ã„ã¤ã„ãŸã€‚

ã¾ãšä¸€ã¤ç›®ã¯ã€ç”»é¢ã‚’ç›£è¦–ã—ã¦ã„ã¦ä¸€å®šä»¥ä¸Šã®å¤‰åŒ–ãŒã‚ã£ãŸå ´åˆã«ã‚¹ã‚¯ã‚·ãƒ§ã™ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€OpenCVã§å‹•ä½“æ¤œçŸ¥ã—ã¦ã€ä¾‹ãˆã°ç”»é¢å…¨ä½“ã®5å‰²ãŒå¤‰åŒ–ã—ãŸã‚‰ã€ã‚¹ã‚¯ã‚·ãƒ§ã‚’ã™ã‚‹ã‚ˆã†ãªæ„Ÿã˜ã€‚

ãŸã ã€ã“ã‚Œã«ã¯é–¾å€¤ã®å¾®èª¿æ•´ãŒå¿…è¦ã§ã‚ã‚Šã€åŠ´åŠ›ãŒå¿…è¦ã§ã‚ã‚‹ã€‚åŠ ãˆã¦ã€å›³1ã®ã‚ˆã†ã«éš…ã£ã“ã«æ•™æŽˆãŒæ˜ ã‚‹å ´åˆã¯å•é¡Œãªã„ã®ã ãŒã€å›³2ã®ã‚ˆã†ã«ç”»é¢å…¨ä½“ã«æ•™æŽˆãŒå†™ã£ã¦æŽˆæ¥­ã‚’ã™ã‚‹ã‚ˆã†ãªå ´åˆã¯ã€æ•™æŽˆã®å‹•ããŒå¤§ããåæ˜ ã—ã¦ã—ã¾ã†ãŸæœ‰ç”¨ã§ã¯ãªã„ã€‚

![å›³1](/images/885ab465c79658/fig1.jpg)
*å›³1: æ•™æŽˆãŒéš…ã£ã“ã«æ˜ ã£ã¦ã„ã‚‹å ´åˆ*

![å›³2](/images/885ab465c79658/fig2.jpg)
*å›³2: æ•™æŽˆãŒç”»é¢å…¨ä½“ã«æ˜ ã‚ŠãªãŒã‚‰æŽˆæ¥­ã‚’ã—ã¦ã„ã‚‹å ´åˆ*


ãã“ã§2ã¤ç›®ã€‚ãƒ™ã‚¿ãªæ–¹æ³•ã ãŒã€ä¸€å®šé–“éš”ã§ã‚¹ã‚¯ã‚·ãƒ§ã‚’æ’®ã‚‹æ–¹æ³•ã§ã‚ã‚‹ã€‚
ã“ã¡ã‚‰ã¯ã€æ•™æŽˆã®å‹•ãã«é–¢ä¿‚ãªãã€å®‰å®šã—ã¦ã‚¹ã‚¯ã‚·ãƒ§ã‚’æ’®ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚



```python
import subprocess
import time
import cv2
import numpy as np
from PIL import ImageGrab

# ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆä¿å­˜å…ˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹
SCREENSHOT_DIR = "/screenshot/zoom"

# å‹•ä½“æ¤œçŸ¥ã®ã—ãã„å€¤ï¼ˆç”»é¢å…¨ä½“ã®å¤‰åŒ–ã®å‰²åˆï¼‰
MOTION_THRESHOLD = 0.5  # Adjust this threshold as needed

def join_zoom_meeting(meeting_id, password):
    command = f"zoommtg://zoom.us/join?action=join&confno={meeting_id}&pwd={password}"
    subprocess.call(["open", command])

def close_zoom_window():
    subprocess.call(["pkill", "zoom.us"])

def capture_screenshot():
    screenshot = ImageGrab.grab()
    timestamp = time.strftime("%Y%m%d_%H%M%S")
    screenshot_path = f"{SCREENSHOT_DIR}/screenshot_{timestamp}.png"
    screenshot.save(screenshot_path)
    print(f"Screenshot saved: {screenshot_path}")

def main():
    meeting_id = "YOUR_MEETING_ID"
    password = "YOUR_PASSWORD"
    target_time = "01:10:00"  # é–‹å§‹ã™ã‚‹æ™‚é–“ã‚’æŒ‡å®š (24æ™‚é–“å½¢å¼)
    meeting_duration = 1  # ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®æŒç¶šæ™‚é–“ã‚’æŒ‡å®š (åˆ†å˜ä½)
    motion_frames = []
    
    while True:
        current_time = time.strftime("%H:%M:%S")
        if current_time >= target_time:
            join_zoom_meeting(meeting_id, password)
            start_time = time.time()
            previous_frame = None  # å‰å›žã®ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä¿æŒã™ã‚‹å¤‰æ•°
            motion_detected = False  # å¤‰åŒ–æ¤œçŸ¥ã®ãƒ•ãƒ©ã‚°
            
            while True:
                # ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å–å¾—ã—ã€å‰å›žã®ãƒ•ãƒ¬ãƒ¼ãƒ ã¨æ¯”è¼ƒã™ã‚‹
                screenshot = np.array(ImageGrab.grab())
                gray = cv2.cvtColor(screenshot, cv2.COLOR_BGR2GRAY)
                gray = cv2.GaussianBlur(gray, (21, 21), 0)
                
                if previous_frame is None:
                    previous_frame = gray
                    continue
                
                frame_delta = cv2.absdiff(previous_frame, gray)
                thresh = cv2.threshold(frame_delta, 30, 255, cv2.THRESH_BINARY)[1]
                thresh = cv2.dilate(thresh, None, iterations=2)
                contours, _ = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
                
                for contour in contours:
                    if cv2.contourArea(contour) > 500:
                        motion_detected = True
                        break
                else:  # add an else block here
                     motion_detected = False

                
                if motion_detected:
                    elapsed_time = time.time() - start_time
                    
                    if elapsed_time >= meeting_duration * 60:
                        capture_screenshot()
                        close_zoom_window()
                        break
                else:
                    motion_detected = False
                
                previous_frame = gray
                time.sleep(0.1)
            
            break
        else:
            time.sleep(1)

if __name__ == "__main__":
    main()


```